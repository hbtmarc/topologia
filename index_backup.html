<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#ffffff" />
  <title>Gorillas • Topologia de Rede (4 Cenários)</title>

  <style>
    :root{
      --bg: #ffffff;
      --bg-alt: #f8f9fc;
      --card: #ffffff;
      --text: #1a202c;
      --text-muted: #64748b;
      --text-light: #94a3b8;
      --border: #e2e8f0;
      --accent: #3b82f6;
      --accent-light: #dbeafe;
      --accent-dark: #1e40af;
      --success: #10b981;
      --success-light: #d1fae5;
      --warning: #f59e0b;
      --warning-light: #fef3c7;
      --purple: #8b5cf6;
      --purple-light: #ede9fe;
      --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.08);
      --shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 12px 48px rgba(0, 0, 0, 0.12);
      --radius: 16px;
      --radius-sm: 12px;
      --radius-lg: 24px;
      --max-width: 1200px;
      --spacing: 20px;
      --mono: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
      --sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
    }

    *{ 
      box-sizing:border-box;
      margin: 0;
      padding: 0;
    }
    
    html{ scroll-behavior: smooth; }
    html,body{ height:100%; }
    
    body{
      margin:0;
      font-family: var(--sans);
      background: linear-gradient(135deg, #f0f9ff 0%, #f8fafc 50%, #faf5ff 100%);
      color: var(--text);
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Floating background elements */
    body::before,
    body::after {
      content: '';
      position: fixed;
      border-radius: 50%;
      opacity: 0.5;
      z-index: 0;
      pointer-events: none;
      animation: float 20s ease-in-out infinite;
    }
    
    body::before {
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, transparent 70%);
      top: -200px;
      right: -200px;
      animation-delay: -5s;
    }
    
    body::after {
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(139, 92, 246, 0.1) 0%, transparent 70%);
      bottom: -150px;
      left: -150px;
    }
    
    @keyframes float {
      0%, 100% { transform: translate(0, 0) scale(1); }
      33% { transform: translate(30px, -30px) scale(1.1); }
      66% { transform: translate(-20px, 20px) scale(0.9); }
    }

    a{ color:inherit; text-decoration:none; }
    button{ font-family:inherit; border: none; outline: none; }
    .wrap{ 
      max-width: var(--max-width); 
      margin: 0 auto; 
      padding: 0 var(--spacing);
      position: relative;
      z-index: 1;
    }

    /* Top bar - Mobile First */
    .topbar{
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(20px) saturate(180%);
      background: rgba(255, 255, 255, 0.85);
      border-bottom: 1px solid var(--border);
      box-shadow: var(--shadow-sm);
    }
    
    .topbar-inner{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 16px 0;
      min-height: 72px;
    }
    
    .brand{
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 0;
      flex: 1;
    }
    
    .logo{
      width: 48px; 
      height: 48px;
      border-radius: var(--radius-sm);
      background: linear-gradient(135deg, var(--accent) 0%, var(--purple) 100%);
      box-shadow: var(--shadow);
      display: grid; 
      place-items: center;
      flex-shrink: 0;
      animation: logoEntry 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    
    @keyframes logoEntry {
      from { 
        transform: scale(0) rotate(-180deg);
        opacity: 0;
      }
      to { 
        transform: scale(1) rotate(0deg);
        opacity: 1;
      }
    }
    
    .logo svg{ 
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }
    
    .brand h1{
      font-size: 15px;
      font-weight: 700;
      margin: 0;
      line-height: 1.3;
      letter-spacing: -0.02em;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    @media (min-width: 640px) {
      .brand h1{
        font-size: 18px;
      }
    }
    
    .brand .sub{
      display: none;
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 2px;
      line-height: 1.4;
    }
    
    @media (min-width: 768px) {
      .brand .sub{
        display: block;
      }
    }

    .actions{
      display: flex;
      gap: 8px;
      flex-shrink: 0;
    }
    
    .btn{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--text);
      padding: 10px 14px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      user-select: none;
      min-height: 44px;
      font-size: 14px;
      font-weight: 500;
      white-space: nowrap;
    }
    
    .btn:hover{ 
      transform: translateY(-2px);
      box-shadow: var(--shadow);
      border-color: var(--accent);
    }
    
    .btn:active{ 
      transform: translateY(0);
    }
    
    .btn.primary{
      border-color: var(--accent);
      background: var(--accent);
      color: white;
    }
    
    .btn.primary:hover{
      background: var(--accent-dark);
      border-color: var(--accent-dark);
    }
    
    .btn svg{ 
      width: 18px; 
      height: 18px;
    }
    
    .btn span.mobile-hide {
      display: none;
    }
    
    @media (min-width: 640px) {
      .btn span.mobile-hide {
        display: inline;
      }
    }

    /* Hero Section - Mobile First */
    main{ 
      padding: 24px 0 60px;
    }
    
    .hero{
      padding: 0 0 24px;
      animation: fadeInUp 0.6s ease-out;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .title{
      font-size: 28px;
      line-height: 1.2;
      margin: 0 0 16px 0;
      letter-spacing: -0.02em;
      font-weight: 800;
      background: linear-gradient(135deg, var(--accent) 0%, var(--purple) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: slideIn 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    
    @media (min-width: 768px) {
      .title{
        font-size: 36px;
      }
    }
    
    @media (min-width: 1024px) {
      .title{
        font-size: 42px;
      }
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .lead{
      margin: 0;
      color: var(--text-muted);
      font-size: 15px;
      line-height: 1.7;
      max-width: 65ch;
    }
    
    @media (min-width: 768px) {
      .lead{
        font-size: 16px;
      }
    }

    /* Chips - Mobile First */
    .chips{
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }
    
    .chip{
      border: 1px solid var(--border);
      background: var(--card);
      padding: 10px 14px;
      border-radius: 999px;
      font-size: 13px;
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      animation: chipPop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      animation-fill-mode: both;
    }
    
    .chip:nth-child(1) { animation-delay: 0.1s; }
    .chip:nth-child(2) { animation-delay: 0.2s; }
    .chip:nth-child(3) { animation-delay: 0.3s; }
    .chip:nth-child(4) { animation-delay: 0.4s; }
    
    @keyframes chipPop {
      from {
        opacity: 0;
        transform: scale(0.5);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }
    
    .chip:hover{
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }
    
    .chip b{ 
      color: var(--text); 
      font-weight: 600;
    }
    
    .dot{ 
      width: 8px; 
      height: 8px; 
      border-radius: 50%; 
      background: var(--accent);
      animation: pulse 2s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.2); }
    }

    /* Tabs - Mobile First */
    .tabs{
      margin-top: 24px;
      display: flex;
      gap: 10px;
      overflow-x: auto;
      overflow-y: hidden;
      padding-bottom: 8px;
      scrollbar-width: thin;
      scrollbar-color: var(--border) transparent;
      -webkit-overflow-scrolling: touch;
    }
    
    .tabs::-webkit-scrollbar {
      height: 6px;
    }
    
    .tabs::-webkit-scrollbar-track {
      background: transparent;
    }
    
    .tabs::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 3px;
    }
    
    .tab{
      flex-shrink: 0;
      border: 2px solid var(--border);
      background: var(--card);
      color: var(--text-muted);
      padding: 12px 18px;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-size: 14px;
      font-weight: 500;
      display: inline-flex;
      gap: 8px;
      align-items: center;
      white-space: nowrap;
    }
    
    .tab:hover{ 
      transform: translateY(-2px) scale(1.02);
      box-shadow: var(--shadow);
    }
    
    .tab[aria-selected="true"]{
      color: white;
      border-color: var(--accent);
      background: linear-gradient(135deg, var(--accent) 0%, var(--purple) 100%);
      box-shadow: var(--shadow);
      transform: translateY(-2px);
    }
    
    .badge{
      font-family: var(--mono);
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid currentColor;
      opacity: 0.8;
      font-weight: 600;
    }

    /* Cards layout - Mobile First */
    .grid{
      display: grid;
      gap: 20px;
      margin-top: 24px;
    }
    
    @media (min-width: 1024px){
      .grid{ 
        grid-template-columns: 1.4fr 1fr; 
        align-items: start; 
      }
    }

    .card{
      border: 1px solid var(--border);
      background: var(--card);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .card:hover{
      box-shadow: var(--shadow-lg);
      transform: translateY(-4px);
    }
    
    .card .hd{
      padding: 24px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(135deg, var(--accent-light) 0%, var(--purple-light) 100%);
    }
    
    .card .hd h2{
      margin: 0;
      font-size: 20px;
      font-weight: 700;
      letter-spacing: -0.02em;
      color: var(--text);
    }
    
    @media (min-width: 768px) {
      .card .hd h2{
        font-size: 22px;
      }
    }
    
    .card .hd p{
      margin: 12px 0 0;
      color: var(--text-muted);
      font-size: 14px;
      line-height: 1.6;
    }
    
    @media (min-width: 768px) {
      .card .hd p{
        font-size: 15px;
      }
    }
    
    .card .bd{ 
      padding: 24px;
    }

    /* Skeleton - Loading */
    .skeleton{
      position: relative;
      overflow: hidden;
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      border-radius: var(--radius);
      min-height: 200px;
      animation: shimmer 1.5s ease-in-out infinite;
    }
    
    @keyframes shimmer{
      0%{ background-position: 200% 0; }
      100%{ background-position: -200% 0; }
    }

    /* Topology SVG - Mobile First */
    .topology-wrap{ 
      position: relative;
      margin-bottom: 24px;
    }
    
    .topology{
      width: 100%;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: linear-gradient(135deg, #fafbfc 0%, #f8f9fc 100%);
      overflow: hidden;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.04);
    }

    /* KPIs - Mobile First */
    .kpis{
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-top: 20px;
    }
    
    @media (min-width: 640px){
      .kpis{ 
        grid-template-columns: repeat(4, 1fr);
      }
    }
    
    .kpi{
      border: 2px solid var(--border);
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .kpi::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--accent), var(--purple));
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }
    
    .kpi:hover::before {
      transform: scaleX(1);
    }
    
    .kpi:hover{
      transform: translateY(-4px);
      box-shadow: var(--shadow);
      border-color: var(--accent);
    }
    
    .kpi .l{ 
      color: var(--text-light); 
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
    }
    
    .kpi .v{ 
      margin-top: 8px; 
      font-size: 18px; 
      font-weight: 800;
      letter-spacing: -0.02em;
      background: linear-gradient(135deg, var(--accent) 0%, var(--purple) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    @media (min-width: 768px) {
      .kpi .v{ 
        font-size: 20px;
      }
    }
    
    .kpi .s{ 
      margin-top: 4px; 
      color: var(--text-muted); 
      font-size: 11px;
    }

    .section{
      margin-top: 20px;
    }

    /* Categories - Mobile First */
    .cat{
      margin-top: 16px;
      border: 1px solid var(--border);
      background: var(--bg-alt);
      border-radius: var(--radius);
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .cat:hover{
      box-shadow: var(--shadow-sm);
    }
    
    .cat .cat-hd{
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      padding: 16px 18px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(135deg, var(--success-light) 0%, var(--warning-light) 100%);
    }
    
    .cat .cat-hd h3{
      margin: 0;
      font-size: 15px;
      font-weight: 700;
      letter-spacing: -0.01em;
      color: var(--text);
    }
    
    @media (min-width: 768px) {
      .cat .cat-hd h3{
        font-size: 16px;
      }
    }
    
    .cat .cat-hd .sum{
      font-family: var(--mono);
      font-size: 14px;
      font-weight: 700;
      color: var(--success);
    }

    .items{
      display: grid;
      gap: 12px;
      padding: 16px;
    }
    
    .item{
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 12px;
      padding: 14px 16px;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--card);
      transition: all 0.3s ease;
    }
    
    .item:hover{
      transform: translateX(4px);
      box-shadow: var(--shadow-sm);
      border-color: var(--accent);
    }
    
    .item .name{
      font-size: 14px;
      line-height: 1.5;
      color: var(--text);
      font-weight: 500;
    }
    
    .item .meta{
      margin-top: 6px;
      color: var(--text-muted);
      font-size: 12px;
      font-family: var(--mono);
    }
    
    .item .price{
      text-align: right;
      font-family: var(--mono);
      font-size: 12px;
      color: var(--text-muted);
    }
    
    .item .price b{
      display: block;
      color: var(--text);
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    /* Service Packs - Mobile First */
    .packs{
      display: grid;
      gap: 16px;
    }
    
    @media (min-width: 640px){
      .packs{ 
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    .pack{
      border: 2px solid var(--border);
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px;
      min-height: 200px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .pack::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent), var(--purple));
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }
    
    .pack:hover::before {
      transform: scaleX(1);
    }
    
    .pack:hover{
      transform: translateY(-6px);
      box-shadow: var(--shadow-lg);
      border-color: var(--accent);
    }
    
    .pack h3{ 
      margin: 0; 
      font-size: 16px;
      font-weight: 700;
      color: var(--text);
    }
    
    .pack .p{ 
      margin-top: 10px; 
      color: var(--text-muted); 
      font-size: 13px; 
      line-height: 1.6;
    }
    
    .pack .range{ 
      margin-top: 14px; 
      font-weight: 800;
      font-size: 18px;
      letter-spacing: -0.02em;
      background: linear-gradient(135deg, var(--accent) 0%, var(--purple) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .pack ul{ 
      margin: 14px 0 0; 
      padding-left: 20px; 
      color: var(--text-muted); 
      font-size: 13px;
      line-height: 1.7;
    }
    
    .pack li{ 
      margin: 6px 0;
    }
    
    .pack li::marker {
      color: var(--accent);
    }

    /* Reveal Animation */
    .reveal{ 
      opacity: 0; 
      transform: translateY(30px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    
    .reveal.in{ 
      opacity: 1; 
      transform: translateY(0);
    }

    /* Toast - Mobile First */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 24px;
      transform: translateX(-50%) translateY(20px);
      background: var(--text);
      color: white;
      border: none;
      padding: 14px 20px;
      border-radius: var(--radius-sm);
      font-size: 14px;
      font-weight: 500;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
      max-width: calc(100vw - 40px);
      text-align: center;
      box-shadow: var(--shadow-lg);
    }
    
    .toast.show{ 
      opacity: 1; 
      transform: translateX(-50%) translateY(0);
    }

    /* Print Styles */
    @media print{
      .topbar, .actions, .btn, .tabs { display: none !important; }
      body{ 
        background: white; 
        color: #111;
      }
      body::before, body::after { display: none; }
      .card{ 
        box-shadow: none;
        page-break-inside: avoid;
      }
      .topology{ 
        border: 1px solid #ccc; 
        background: white;
      }
      a{ text-decoration: none; }
    }

    /* Accessibility */
    @media (prefers-reduced-motion: reduce){
      *,
      *::before,
      *::after{ 
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
      .skeleton{ animation: none; }
      body::before, body::after { animation: none; }
    }
    
    /* Focus visible for keyboard navigation */
    *:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="wrap">
      <div class="topbar-inner">
        <div class="brand">
          <div class="logo" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" width="28" height="28">
              <path d="M6 14c3.2-4.8 8.8-4.8 12 0" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
              <path d="M8 16c2.1-3.1 5.9-3.1 8 0" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
              <circle cx="12" cy="19" r="1.5" fill="white"/>
              <path d="M4 9c4.6-6.9 11.4-6.9 16 0" stroke="white" stroke-width="2.5" stroke-linecap="round" opacity=".8"/>
            </svg>
          </div>
          <div style="min-width:0">
            <h1>Gorillas • Topologia de Rede</h1>
            <div class="sub" id="subtitle">4 cenários orçados • 2 links com failover • 14+ dispositivos</div>
          </div>
        </div>

        <div class="actions">
          <button class="btn" id="btnCopy" title="Copiar orçamento do cenário atual">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M9 9h10v10H9V9Z" stroke="currentColor" stroke-width="2"/>
              <path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span class="mobile-hide">Copiar</span>
          </button>
          <button class="btn primary" id="btnPrint" title="Imprimir / salvar em PDF">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M6 9V4h12v5" stroke="currentColor" stroke-width="2"/>
              <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" stroke="currentColor" stroke-width="2"/>
              <path d="M8 14h8v7H8v-7Z" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span class="mobile-hide">Imprimir / PDF</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="wrap">
        <h2 class="title">Proposta de topologia e levantamento de materiais</h2>
        <p class="lead">
          Apresentação para cliente com quatro cenários: <b>Barato</b>, <b>Custo-benefício</b>, <b>Melhor dos mundos</b> e <b>Recomendado</b>.
          Estrutura: 2 links WAN com <b>failover</b>, core <b>Gigabit</b>, 4 APs (3 salão + 1 bar), rack de chão (rede + CFTV).
          Escopo: <b>materiais</b> + <b>serviço sênior</b> (sem infraestrutura de cabeamento horizontal).
        </p>

        <div class="chips" aria-label="Resumo rápido">
          <span class="chip"><span class="dot"></span> <b>2x WAN</b> com failover</span>
          <span class="chip"><span class="dot" style="background:var(--success)"></span> <b>Core Gigabit</b> end-to-end</span>
          <span class="chip"><span class="dot" style="background:var(--warning)"></span> <b>4 APs</b> (salão/bar)</span>
          <span class="chip"><span class="dot" style="background:var(--purple)"></span> <b>14+</b> dispositivos cabeados</span>
        </div>

        <nav class="tabs" role="tablist" aria-label="Cenários">
          <button class="tab" role="tab" id="tabA" aria-selected="true" data-scn="A"><span class="badge">A</span> Barato</button>
          <button class="tab" role="tab" id="tabB" aria-selected="false" data-scn="B"><span class="badge">B</span> Custo-benefício</button>
          <button class="tab" role="tab" id="tabC" aria-selected="false" data-scn="C"><span class="badge">C</span> Melhor dos mundos</button>
          <button class="tab" role="tab" id="tabD" aria-selected="false" data-scn="D"><span class="badge">D</span> Recomendado</button>
        </nav>

        <div class="grid">
          <!-- Left: Topologia + Materiais -->
          <div class="card reveal" id="cardTopo">
            <div class="hd">
              <h2 id="scnTitle">Cenário A — Barato</h2>
              <p id="scnDesc">Gigabit no core com PoE econômico, Wi-Fi 5, proteção elétrica (iClamper + PDU), sem nobreak.</p>

              <div class="kpis" aria-label="Indicadores">
                <div class="kpi"><div class="l">Materiais</div><div class="v" id="kpiTotal">R$ —</div><div class="s">Total estimado</div></div>
                <div class="kpi"><div class="l">Roteamento</div><div class="v" id="kpiWan">2x WAN</div><div class="s">failover</div></div>
                <div class="kpi"><div class="l">Wi-Fi</div><div class="v" id="kpiWifi">—</div><div class="s">4 APs</div></div>
                <div class="kpi"><div class="l">LAN</div><div class="v">14+</div><div class="s">dispositivos</div></div>
              </div>
            </div>

            <div class="bd">
              <div class="topology-wrap">
                <div id="topoSkeleton" class="skeleton" aria-hidden="true"></div>

                <svg id="topoSvg" class="topology" viewBox="0 0 900 360" role="img" aria-label="Diagrama de topologia (atualiza por cenário)" style="display:none">
                  <defs>
                    <linearGradient id="nodeGrad" x1="0" x2="1">
                      <stop offset="0" stop-color="rgba(59, 130, 246, 0.1)"/>
                      <stop offset="1" stop-color="rgba(139, 92, 246, 0.1)"/>
                    </linearGradient>
                    <filter id="softShadow" x="-20%" y="-20%" width="140%" height="140%">
                      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="rgba(0,0,0,.1)"/>
                    </filter>
                  </defs>

                  <!-- Links -->
                  <g fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <!-- WAN -> Router -->
                    <path class="ln anim" id="lnWan1" d="M150 95 H240" stroke="var(--accent)" stroke-width="3"/>
                    <path class="ln anim" id="lnWan2" d="M150 165 H240" stroke="var(--accent)" stroke-width="3"/>

                    <!-- Router -> Switch Core -->
                    <path class="ln anim" id="lnRouterToCore" d="M380 130 H440" stroke="var(--success)" stroke-width="3"/>

                    <!-- Core -> PoE (A/B) -->
                    <path class="ln anim" id="lnCoreToPoe" d="M560 110 V60" stroke="var(--success)" stroke-width="3"/>

                    <!-- PoE -> APs -->
                    <path class="ln anim" id="lnPoeToAp1" d="M620 60 H740" stroke="var(--warning)" stroke-width="3"/>
                    <path class="ln anim" id="lnPoeToAp2" d="M620 100 H740" stroke="var(--warning)" stroke-width="3"/>
                    <path class="ln anim" id="lnPoeToAp3" d="M620 140 H740" stroke="var(--warning)" stroke-width="3"/>
                    <path class="ln anim" id="lnPoeToAp4" d="M620 180 H740" stroke="var(--warning)" stroke-width="3"/>

                    <!-- Core -> LAN / DVR -->
                    <path class="ln anim" id="lnCoreToLan" d="M560 150 H740" stroke="var(--success)" stroke-width="3"/>
                    <path class="ln anim" id="lnCoreToDvr" d="M560 210 H740" stroke="var(--text-muted)" stroke-width="3"/>

                    <!-- Core (C/D) -> APs direct -->
                    <path class="ln anim" id="lnCoreDirectToAp1" d="M560 70 H740" stroke="var(--warning)" stroke-width="3"/>
                    <path class="ln anim" id="lnCoreDirectToAp2" d="M560 110 H740" stroke="var(--warning)" stroke-width="3"/>
                    <path class="ln anim" id="lnCoreDirectToAp3" d="M560 150 H740" stroke="var(--warning)" stroke-width="3"/>
                    <path class="ln anim" id="lnCoreDirectToAp4" d="M560 190 H740" stroke="var(--warning)" stroke-width="3"/>

                    <!-- Energia (tracejado) -->
                    <path class="pw" id="pwEnergy" d="M215 290 H680" stroke="var(--border)" stroke-width="2" stroke-dasharray="6 6"/>
                    <path class="pw" id="pwUps" d="M360 290 H430" stroke="var(--border)" stroke-width="2" stroke-dasharray="6 6"/>
                  </g>

                  <!-- Nodes -->
                  <g filter="url(#softShadow)">
                    <!-- WAN nodes -->
                    <rect x="40" y="70" width="110" height="50" rx="12" fill="url(#nodeGrad)" stroke="var(--border)" stroke-width="2"/>
                    <text x="95" y="99" text-anchor="middle" font-size="13" font-weight="600" fill="var(--text)">WAN1</text>

                    <rect x="40" y="140" width="110" height="50" rx="12" fill="url(#nodeGrad)" stroke="var(--border)" stroke-width="2"/>
                    <text x="95" y="169" text-anchor="middle" font-size="13" font-weight="600" fill="var(--text)">WAN2</text>

                    <!-- Router -->
                    <rect x="240" y="95" width="140" height="70" rx="14" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                    <text x="310" y="125" text-anchor="middle" font-size="13" font-weight="700" fill="var(--text)">R3005G</text>
                    <text x="310" y="142" text-anchor="middle" font-size="11" fill="var(--text-muted)">Dual WAN • failover</text>

                    <!-- Switch Core -->
                    <rect x="440" y="95" width="120" height="70" rx="14" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                    <text id="swCoreLabel1" x="500" y="125" text-anchor="middle" font-size="12" font-weight="700" fill="var(--text)">Switch Core</text>
                    <text id="swCoreLabel2" x="500" y="142" text-anchor="middle" font-size="11" fill="var(--text-muted)">24p Gigabit</text>

                    <!-- Switch PoE (A/B) -->
                    <g id="poeNode">
                      <rect x="500" y="30" width="120" height="55" rx="14" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                      <text id="swPoeLabel1" x="560" y="55" text-anchor="middle" font-size="12" font-weight="700" fill="var(--text)">Switch PoE</text>
                      <text id="swPoeLabel2" x="560" y="72" text-anchor="middle" font-size="11" fill="var(--text-muted)">Gigabit</text>
                    </g>

                    <!-- APs -->
                    <g id="aps">
                      <rect x="740" y="40" width="140" height="34" rx="12" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                      <text id="ap1" x="810" y="61" text-anchor="middle" font-size="12" font-weight="600" fill="var(--text)">AP Salão 1</text>

                      <rect x="740" y="80" width="140" height="34" rx="12" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                      <text id="ap2" x="810" y="101" text-anchor="middle" font-size="12" font-weight="600" fill="var(--text)">AP Salão 2</text>

                      <rect x="740" y="120" width="140" height="34" rx="12" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                      <text id="ap3" x="810" y="141" text-anchor="middle" font-size="12" font-weight="600" fill="var(--text)">AP Salão 3</text>

                      <rect x="740" y="160" width="140" height="34" rx="12" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                      <text id="ap4" x="810" y="181" text-anchor="middle" font-size="12" font-weight="600" fill="var(--text)">AP Bar</text>
                    </g>

                    <!-- LAN + DVR -->
                    <rect x="740" y="220" width="140" height="44" rx="14" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                    <text x="810" y="245" text-anchor="middle" font-size="12" font-weight="700" fill="var(--text)">LAN (14+)</text>
                    <text x="810" y="260" text-anchor="middle" font-size="11" fill="var(--text-muted)">PDV, impressoras, etc.</text>

                    <rect x="740" y="280" width="140" height="44" rx="14" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                    <text x="810" y="305" text-anchor="middle" font-size="12" font-weight="700" fill="var(--text)">DVR/NVR</text>
                    <text x="810" y="320" text-anchor="middle" font-size="11" fill="var(--text-muted)">CFTV</text>

                    <!-- Energia -->
                    <rect x="40" y="270" width="170" height="64" rx="14" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                    <text x="125" y="296" text-anchor="middle" font-size="12" font-weight="700" fill="var(--text)">Energia</text>
                    <text id="energyLabel" x="125" y="314" text-anchor="middle" font-size="11" fill="var(--text-muted)">iClamper + PDU</text>

                    <g id="upsNode">
                      <rect x="240" y="270" width="150" height="64" rx="14" fill="var(--card)" stroke="var(--border)" stroke-width="2"/>
                      <text x="315" y="296" text-anchor="middle" font-size="12" font-weight="700" fill="var(--text)">Nobreak</text>
                      <text x="315" y="314" text-anchor="middle" font-size="11" fill="var(--text-muted)">XNB 1200</text>
                    </g>
                  </g>
                </svg>
              </div>

              <div class="section">
                <div class="cat" id="materials"></div>
              </div>
            </div>
          </div>

          <!-- Right: Serviço + Escopo -->
          <aside>
            <div class="card reveal" id="cardService">
              <div class="hd">
                <h2>Serviço sênior (projeto + configuração + entrega)</h2>
                <p>
                  Escopo típico: configuração do R3005G (dual WAN com failover), segmentação (SSID/VLAN quando aplicável),
                  testes e documentação de entrega (handover).
                </p>
              </div>
              <div class="bd">
                <div class="packs" id="packs"></div>

                <div class="section">
                  <div style="border:2px solid var(--border); border-radius:var(--radius); padding:18px; background:var(--bg-alt)">
                    <div style="font-weight:700; margin-bottom:10px; color:var(--text);">⚠️ Premissas e fora de escopo</div>
                    <div style="color:var(--text-muted); font-size:13px; line-height:1.7">
                      Inclui levantamento de materiais, arquitetura lógica e configuração. Não inclui cabeamento horizontal,
                      infraestrutura civil (eletrocalhas/canaletas), certificação de rede, nem mão de obra de passagem/crimpagem.
                      Valores de materiais são referenciais e devem ser atualizados no ato da compra/cotação.
                    </div>
                  </div>
                </div>

                <div class="section" style="display:flex; gap:12px; flex-wrap:wrap">
                  <a class="btn" href="#materials" style="text-decoration:none">Ver materiais</a>
                  <button class="btn" id="btnShare">Copiar link</button>
                </div>

                <div class="section" style="color:var(--text-light); font-size:12px">
                  Atualizado em <span id="updatedAt">—</span>.
                </div>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </section>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    // ---------- Dados (ajuste livre) ----------
    // Totais e itens refletem o levantamento que você aprovou na conversa.
    // Preços: referenciais; atualize conforme sua cotação real.
    const cenarios = {
      A: {
        code: "A",
        nome: "Barato",
        titulo: "Cenário A — Barato",
        desc: "Gigabit no core com PoE econômico, Wi-Fi 5, proteção elétrica (iClamper + PDU), sem nobreak.",
        wifi: "Wi-Fi 5 (AP 1350 AC-S)",
        topoMode: "DUAL_SWITCH_NO_UPS",
        totais: { materiais: 7680.35 },
        categorias: [
          {
            nome: "Ativos • Roteamento e Switching",
            itens: [
              { nome: "Intelbras R3005G (dual WAN com failover)", qtd: 1, un: 599.90 },
              { nome: "Intelbras S1124G (24 portas Gigabit, não-PoE)", qtd: 1, un: 829.88 },
              { nome: "Intelbras S1110G-PA (PoE+ Gigabit, 8 portas PoE)", qtd: 1, un: 874.72 },
            ]
          },
          {
            nome: "Wi-Fi",
            itens: [
              { nome: "Intelbras AP 1350 AC-S (Wi-Fi 5) — 4 APs (3 salão + 1 bar)", qtd: 4, un: 890.28 },
            ]
          },
          {
            nome: "Rack e Elétrica",
            itens: [
              { nome: "Rack de chão 19\" (referência 19U)", qtd: 1, un: 1164.53 },
              { nome: "PDU 19\" (8 tomadas)", qtd: 1, un: 64.90 },
              { nome: "Clamper iClamper Energia 8 (DPS)", qtd: 1, un: 147.99 },
            ]
          },
          {
            nome: "Acessórios",
            itens: [
              { nome: "Bandeja 1U (rack)", qtd: 1, un: 90.16 },
              { nome: "Guias de cabo 1U (rack)", qtd: 2, un: 32.08 },
              { nome: "Patch cords Cat6 1 m (organização rack/AP/uplinks)", qtd: 10, un: 14.59 },
              { nome: "Miudezas (RJ45/porca-gaiola/velcro/etiquetas) — estimativa", qtd: 1, un: 137.09 },
            ]
          }
        ],
        servico: [
          { nome: "Essencial", faixa: "R$ 1.800 – 2.800", bullets: ["Configuração R3005G (WAN1/WAN2 + failover)", "SSID Guest + Staff, regras básicas", "Checklist e handover"] },
          { nome: "Completo", faixa: "R$ 3.200 – 5.500", bullets: ["Tudo do Essencial", "Políticas de isolamento/limite de banda", "Documentação (mapa lógico + inventário)"] },
          { nome: "Recomendado", faixa: "R$ 5.500 – 8.500", bullets: ["Tudo do Completo", "Pós go-live assistido", "Hardening e backup de configurações"] },
        ]
      },

      B: {
        code: "B",
        nome: "Custo-benefício",
        titulo: "Cenário B — Custo-benefício",
        desc: "Mantém PoE econômico, sobe o Wi-Fi para Wi-Fi 6 e adiciona nobreak simples.",
        wifi: "Wi-Fi 6 (AP 3000 AX)",
        topoMode: "DUAL_SWITCH_WITH_UPS",
        totais: { materiais: 10422.95 },
        categorias: [
          {
            nome: "Ativos • Roteamento e Switching",
            itens: [
              { nome: "Intelbras R3005G (dual WAN com failover)", qtd: 1, un: 599.90 },
              { nome: "Intelbras S1124G (24 portas Gigabit, não-PoE)", qtd: 1, un: 829.88 },
              { nome: "Intelbras S1110G-PA (PoE+ Gigabit, 8 portas PoE)", qtd: 1, un: 874.72 },
            ]
          },
          {
            nome: "Wi-Fi",
            itens: [
              { nome: "Intelbras AP 3000 AX (Wi-Fi 6) — 4 APs (3 salão + 1 bar)", qtd: 4, un: 1495.36 },
            ]
          },
          {
            nome: "Rack e Elétrica",
            itens: [
              { nome: "Nobreak Intelbras XNB 1200", qtd: 1, un: 322.28 },
              { nome: "Rack de chão 19\" (referência 19U)", qtd: 1, un: 1164.53 },
              { nome: "PDU 19\" (8 tomadas)", qtd: 1, un: 64.90 },
              { nome: "Clamper iClamper Energia 8 (DPS)", qtd: 1, un: 147.99 },
            ]
          },
          {
            nome: "Acessórios",
            itens: [
              { nome: "Bandeja 1U (rack)", qtd: 1, un: 90.16 },
              { nome: "Guias de cabo 1U (rack)", qtd: 2, un: 32.08 },
              { nome: "Patch cords Cat6 1 m (organização rack/AP/uplinks)", qtd: 10, un: 14.59 },
              { nome: "Miudezas (RJ45/porca-gaiola/velcro/etiquetas) — estimativa", qtd: 1, un: 137.09 },
            ]
          }
        ],
        servico: [
          { nome: "Essencial", faixa: "R$ 1.800 – 2.800", bullets: ["Configuração R3005G (WAN1/WAN2 + failover)", "SSID Guest + Staff, regras básicas", "Checklist e handover"] },
          { nome: "Completo", faixa: "R$ 3.200 – 5.500", bullets: ["Tudo do Essencial", "Otimização Wi-Fi 6 (canal/potência/roaming)", "Documentação (mapa lógico + inventário)"] },
          { nome: "Recomendado", faixa: "R$ 5.500 – 8.500", bullets: ["Tudo do Completo", "Pós go-live assistido", "Hardening e backup de configurações"] },
        ]
      },

      C: {
        code: "C",
        nome: "Melhor dos mundos",
        titulo: "Cenário C — Melhor dos mundos",
        desc: "Core PoE gerenciável (VLAN/QoS) e APs Wi-Fi 5 para segurar custo, com nobreak simples.",
        wifi: "Wi-Fi 5 (AP 1350 AC-S)",
        topoMode: "SINGLE_POE_CORE_WITH_UPS",
        totais: { materiais: 11296.03 },
        categorias: [
          {
            nome: "Ativos • Roteamento e Switching",
            itens: [
              { nome: "Intelbras R3005G (dual WAN com failover)", qtd: 1, un: 599.90 },
              { nome: "Intelbras S2328G-PA (24 portas Gigabit PoE gerenciável: VLAN/QoS)", qtd: 1, un: 4998.00 },
            ]
          },
          {
            nome: "Wi-Fi",
            itens: [
              { nome: "Intelbras AP 1350 AC-S (Wi-Fi 5) — 4 APs (3 salão + 1 bar)", qtd: 4, un: 890.28 },
            ]
          },
          {
            nome: "Rack e Elétrica",
            itens: [
              { nome: "Nobreak Intelbras XNB 1200", qtd: 1, un: 322.28 },
              { nome: "Rack de chão 19\" (referência 19U)", qtd: 1, un: 1164.53 },
              { nome: "PDU 19\" (8 tomadas)", qtd: 1, un: 64.90 },
              { nome: "Clamper iClamper Energia 8 (DPS)", qtd: 1, un: 147.99 },
            ]
          },
          {
            nome: "Acessórios",
            itens: [
              { nome: "Bandeja 1U (rack)", qtd: 1, un: 90.16 },
              { nome: "Guias de cabo 1U (rack)", qtd: 2, un: 32.08 },
              { nome: "Patch cords Cat6 1 m (organização rack/AP/uplinks)", qtd: 10, un: 14.59 },
              { nome: "Miudezas (RJ45/porca-gaiola/velcro/etiquetas) — estimativa", qtd: 1, un: 137.09 },
            ]
          }
        ],
        servico: [
          { nome: "Essencial", faixa: "R$ 1.800 – 2.800", bullets: ["Configuração R3005G (WAN1/WAN2 + failover)", "SSID Guest + Staff", "Checklist e handover"] },
          { nome: "Completo", faixa: "R$ 3.200 – 5.500", bullets: ["Tudo do Essencial", "VLAN 10/11/12 + regras", "Documentação (mapa lógico + inventário)"] },
          { nome: "Recomendado", faixa: "R$ 5.500 – 8.500", bullets: ["Tudo do Completo", "QoS e governança (priorizar PDV/TEF)", "Pós go-live assistido"] },
        ]
      },

      D: {
        code: "D",
        nome: "Recomendado",
        titulo: "Cenário D — Recomendado",
        desc: "Core PoE gerenciável (VLAN/QoS) + Wi-Fi 6 + nobreak. Melhor experiência em ambiente cheio.",
        wifi: "Wi-Fi 6 (AP 3000 AX)",
        topoMode: "SINGLE_POE_CORE_WITH_UPS",
        totais: { materiais: 13716.35 },
        categorias: [
          {
            nome: "Ativos • Roteamento e Switching",
            itens: [
              { nome: "Intelbras R3005G (dual WAN com failover)", qtd: 1, un: 599.90 },
              { nome: "Intelbras S2328G-PA (24 portas Gigabit PoE gerenciável: VLAN/QoS)", qtd: 1, un: 4998.00 },
            ]
          },
          {
            nome: "Wi-Fi",
            itens: [
              { nome: "Intelbras AP 3000 AX (Wi-Fi 6) — 4 APs (3 salão + 1 bar)", qtd: 4, un: 1495.36 },
            ]
          },
          {
            nome: "Rack e Elétrica",
            itens: [
              { nome: "Nobreak Intelbras XNB 1200", qtd: 1, un: 322.28 },
              { nome: "Rack de chão 19\" (referência 19U)", qtd: 1, un: 1164.53 },
              { nome: "PDU 19\" (8 tomadas)", qtd: 1, un: 64.90 },
              { nome: "Clamper iClamper Energia 8 (DPS)", qtd: 1, un: 147.99 },
            ]
          },
          {
            nome: "Acessórios",
            itens: [
              { nome: "Bandeja 1U (rack)", qtd: 1, un: 90.16 },
              { nome: "Guias de cabo 1U (rack)", qtd: 2, un: 32.08 },
              { nome: "Patch cords Cat6 1 m (organização rack/AP/uplinks)", qtd: 10, un: 14.59 },
              { nome: "Miudezas (RJ45/porca-gaiola/velcro/etiquetas) — estimativa", qtd: 1, un: 137.09 },
            ]
          }
        ],
        servico: [
          { nome: "Essencial", faixa: "R$ 1.800 – 2.800", bullets: ["Configuração R3005G (WAN1/WAN2 + failover)", "SSID Guest + Staff", "Checklist e handover"] },
          { nome: "Completo", faixa: "R$ 3.200 – 5.500", bullets: ["Tudo do Essencial", "VLAN 10/11/12 + regras + rate-limit no Guest", "Documentação (mapa lógico + inventário)"] },
          { nome: "Recomendado", faixa: "R$ 5.500 – 8.500", bullets: ["Tudo do Completo", "QoS priorizando PDV/TEF", "Pós go-live assistido"] },
        ]
      }
    };

    // ---------- Helpers ----------
    const brl = (v) => new Intl.NumberFormat("pt-BR", { style:"currency", currency:"BRL" }).format(v);
    const byId = (id) => document.getElementById(id);
    const sleep = (ms) => new Promise(r => setTimeout(r, ms));

    function toast(msg){
      const t = byId("toast");
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(()=> t.classList.remove("show"), 1800);
    }

    function calcCategoriaTotal(cat){
      return cat.itens.reduce((acc,i)=> acc + (i.qtd * i.un), 0);
    }

    function buildMateriaisUI(c){
      const wrap = byId("materials");
      wrap.innerHTML = "";

      // Container principal
      const container = document.createElement("div");
      container.className = "cat";
      container.style.border = "none";
      container.style.background = "transparent";

      c.categorias.forEach((cat) => {
        const catTotal = calcCategoriaTotal(cat);

        const box = document.createElement("div");
        box.className = "cat";

        const hd = document.createElement("div");
        hd.className = "cat-hd";

        const h3 = document.createElement("h3");
        h3.textContent = cat.nome;

        const sum = document.createElement("div");
        sum.className = "sum";
        sum.textContent = brl(catTotal);

        hd.appendChild(h3);
        hd.appendChild(sum);

        const items = document.createElement("div");
        items.className = "items";

        cat.itens.forEach((it) => {
          const row = document.createElement("div");
          row.className = "item";

          const left = document.createElement("div");
          const nm = document.createElement("div");
          nm.className = "name";
          nm.textContent = it.nome;

          const meta = document.createElement("div");
          meta.className = "meta";
          meta.textContent = `Qtd: ${it.qtd} • Unit: ${brl(it.un)}`;

          left.appendChild(nm);
          left.appendChild(meta);

          const right = document.createElement("div");
          right.className = "price";
          const sub = it.qtd * it.un;
          right.innerHTML = `<b>${brl(sub)}</b><span>Subtotal</span>`;

          row.appendChild(left);
          row.appendChild(right);
          items.appendChild(row);
        });

        box.appendChild(hd);
        box.appendChild(items);
        container.appendChild(box);
      });

      wrap.appendChild(container);
    }

    function buildServicosUI(c){
      const packs = byId("packs");
      packs.innerHTML = "";

      c.servico.forEach((p, idx) => {
        const card = document.createElement("div");
        card.className = "pack";
        card.style.borderColor = idx === 2 ? "rgba(124,196,255,.35)" : "var(--line)";

        const h = document.createElement("h3");
        h.textContent = p.nome;

        const range = document.createElement("div");
        range.className = "range";
        range.textContent = p.faixa;

        const ul = document.createElement("ul");
        p.bullets.forEach(b=>{
          const li = document.createElement("li");
          li.textContent = b;
          ul.appendChild(li);
        });

        card.appendChild(h);
        card.appendChild(range);
        card.appendChild(ul);
        packs.appendChild(card);
      });
    }

    function setTabs(active){
      document.querySelectorAll(".tab").forEach(btn=>{
        btn.setAttribute("aria-selected", btn.dataset.scn === active ? "true" : "false");
      });
    }

    function setTopologyMode(mode, c){
      const poeNode = byId("poeNode");
      const upsNode = byId("upsNode");

      // Links A/B (dual switch)
      const abLinks = ["lnCoreToPoe","lnPoeToAp1","lnPoeToAp2","lnPoeToAp3","lnPoeToAp4"];
      // Links C/D (core direto nos APs)
      const cdLinks = ["lnCoreDirectToAp1","lnCoreDirectToAp2","lnCoreDirectToAp3","lnCoreDirectToAp4"];

      const show = (id, on) => { const el = byId(id); if(el) el.style.display = on ? "" : "none"; };

      const isDual = mode.includes("DUAL_SWITCH");
      const hasUps = mode.includes("WITH_UPS") || mode.includes("SINGLE_POE_CORE_WITH_UPS");

      poeNode.style.display = isDual ? "" : "none";
      upsNode.style.display = hasUps ? "" : "none";

      abLinks.forEach(id => show(id, isDual));
      cdLinks.forEach(id => show(id, !isDual));

      // Energia (linha UPS aparece somente se houver UPS)
      show("pwUps", hasUps);

      // Ajusta rótulos do switch
      byId("swCoreLabel1").textContent = isDual ? "Switch Core" : "Switch PoE Core";
      byId("swCoreLabel2").textContent = isDual ? "24p Gigabit" : "24p Gigabit PoE";

      // Rótulo do switch PoE (A/B)
      if(isDual){
        byId("swPoeLabel1").textContent = "Switch PoE";
        byId("swPoeLabel2").textContent = "Gigabit";
      }

      // Rótulo dos APs
      const apBase = c.wifi.includes("Wi-Fi 6") ? "AP 3000 AX" : "AP 1350 AC-S";
      byId("ap1").textContent = `${apBase} • Salão 1`;
      byId("ap2").textContent = `${apBase} • Salão 2`;
      byId("ap3").textContent = `${apBase} • Salão 3`;
      byId("ap4").textContent = `${apBase} • Bar`;

      // Energia label
      byId("energyLabel").textContent = hasUps ? "iClamper + PDU (+ Nobreak)" : "iClamper + PDU";
    }

    function animateLines(){
      // “desenha” as linhas visíveis
      document.querySelectorAll("#topoSvg .anim").forEach(p=>{
        if(p.style.display === "none") return;
        const len = p.getTotalLength();
        p.style.strokeDasharray = String(len);
        p.style.strokeDashoffset = String(len);
        p.style.transition = "stroke-dashoffset .7s ease";
        // trigger
        requestAnimationFrame(()=> { p.style.strokeDashoffset = "0"; });
      });
    }

    async function renderScenario(key, {initial=false} = {}){
      const c = cenarios[key];

      setTabs(key);

      byId("scnTitle").textContent = c.titulo;
      byId("scnDesc").textContent = c.desc;
      byId("kpiTotal").textContent = brl(c.totais.materiais);
      byId("kpiWifi").textContent = c.wifi;

      buildMateriaisUI(c);
      buildServicosUI(c);

      // Skeleton + render do SVG
      byId("topoSkeleton").style.display = "";
      byId("topoSvg").style.display = "none";

      if(!initial) await sleep(350);

      byId("topoSkeleton").style.display = "none";
      byId("topoSvg").style.display = "";

      setTopologyMode(c.topoMode, c);
      animateLines();

      // Atualiza hash (link compartilhável)
      history.replaceState(null, "", `#${key}`);
    }

    function buildCopyText(c){
      const lines = [];
      lines.push(`Gorillas • ${c.titulo}`);
      lines.push(`Resumo: 2 links WAN com failover • Core Gigabit • 4 APs • 14+ dispositivos cabeados`);
      lines.push(`Total materiais (referencial): ${brl(c.totais.materiais)}`);
      lines.push("");
      c.categorias.forEach(cat=>{
        lines.push(`${cat.nome}: ${brl(calcCategoriaTotal(cat))}`);
        cat.itens.forEach(it=>{
          lines.push(`- ${it.qtd}x ${it.nome} | Unit ${brl(it.un)} | Sub ${brl(it.qtd*it.un)}`);
        });
        lines.push("");
      });
      lines.push("Serviço sênior (referência):");
      c.servico.forEach(p=> lines.push(`- ${p.nome}: ${p.faixa}`));
      lines.push("");
      lines.push("Observação: valores referenciais; atualização conforme cotação real. Escopo sem infraestrutura de cabeamento horizontal.");
      return lines.join("\n");
    }

    async function copyToClipboard(text){
      try{
        await navigator.clipboard.writeText(text);
        toast("Copiado para a área de transferência.");
      }catch(e){
        // fallback
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
        toast("Copiado (modo compatibilidade).");
      }
    }

    function initReveal(){
      const obs = new IntersectionObserver((entries)=>{
        entries.forEach(en=>{
          if(en.isIntersecting) en.target.classList.add("in");
        });
      }, { threshold: .12 });
      document.querySelectorAll(".reveal").forEach(el=> obs.observe(el));
    }

    // ---------- Boot ----------
    (function(){
      initReveal();

      const updatedAt = new Intl.DateTimeFormat("pt-BR", { dateStyle:"medium" }).format(new Date());
      byId("updatedAt").textContent = updatedAt;

      // Tabs
      document.querySelectorAll(".tab").forEach(btn=>{
        btn.addEventListener("click", ()=> renderScenario(btn.dataset.scn));
      });

      byId("btnPrint").addEventListener("click", ()=> window.print());

      byId("btnCopy").addEventListener("click", ()=>{
        const key = (location.hash || "#A").replace("#","").toUpperCase();
        const scn = cenarios[key] ? key : "A";
        copyToClipboard(buildCopyText(cenarios[scn]));
      });

      byId("btnShare").addEventListener("click", ()=>{
        copyToClipboard(location.href);
      });

      // Start scenario by hash
      const key = (location.hash || "#A").replace("#","").toUpperCase();
      const scn = cenarios[key] ? key : "A";
      renderScenario(scn, {initial:true});
    })();
  </script>
</body>
</html>
